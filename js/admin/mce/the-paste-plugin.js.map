{"version":3,"sources":["admin/mce/node_modules/browser-pack/_prelude.js","admin/mce/src/js/admin/mce/the-paste-plugin/index.js","admin/mce/src/js/lib/compat.js","admin/mce/src/js/lib/converter.js","admin/mce/src/js/lib/filename.js","admin/mce/src/js/lib/mime.js","admin/mce/src/js/lib/notices.js","admin/mce/src/js/lib/uploader.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_interopRequireDefault","window","global","_converter","_notices","_uploader","obj","__esModule","default","_classPrivateFieldInitSpec","privateMap","value","_checkPrivateRedeclaration","has","TypeError","set","_classPrivateFieldSet","receiver","_classApplyDescriptorSet","_classExtractFieldDescriptor","_classPrivateFieldGet","_classApplyDescriptorGet","action","get","_classStaticPrivateFieldSpecGet","classConstructor","descriptor","_classCheckPrivateStaticAccess","_classCheckPrivateStaticFieldDescriptor","_classStaticPrivateFieldSpecSet","undefined","writable","_files","WeakMap","_isAsync","PasteOperation","init","event","let","preferFiles","arguments","_instance","destroy","setEnabled","enabled","_isEnabled","isAsync","this","hasPastedFiles","files","pastedContent","map","file","idx","src","URL","createObjectURL","concat","type","name","join","constructor","_this$clipboardData$f","clipboardData","body","target","closest","Array","from","items","filter","item","kind","loc","document","location","html","await","clipboardItemsToHtml","div","createElement","placeholder","querySelector","images","nodes","innerHTML","push","querySelectorAll","childNodes","node","Node","ELEMENT_NODE","TEXT_NODE","includes","nodeType","before","remove","protocol","hostname","urlToBlobUrl","dispatchEvent","Event","dumpClipboardData","prefix","forEach","el","console","log","getAsString","s","getAsFile","tinymce","PluginManager","add","editor","pasteOnOffBtn","toolbar","addButton","icon","tooltip","thepaste","l10n","paste_files","onPostRender","onClick","active","fetch","options","enable_ajax_url","once","wp","_createToolbar","upload_image","onclick","inlineUpload","selection","getNode","on","uploadBtn","element","nodeName","isPlaceholder","$el","find","canUpload","img","sub","substring","hide","show","crawlPastedImages","dom","doc","_ref","state","disabled","addEventListener","classList","catch","err","error","message","matches","pasteOperation","debugMode","editorPreProcess","content","editorPostProcess","setTimeout","off","ie","alt","supports","svg","_wpPluploadSettings","defaults","filters","mime_types","extensions","split","webp","toDataURL","indexOf","rml","getSource","_compat","_filename","Converter","clipboardItemsToFiles","clipboardItems","Promise","resolve","reject","promises","_textPlain$textHtml","text/plain","str","itemToString","toLowerCase","DOMParser","parseFromString","stringToFile","text/html","imgs","elementToFile","allSettled","then","result","promise","fl","size","gdocsItemToSources","Object","values","JSON","parse","data","image_urls","gdocsItemToFiles","sources","blobUrlToFile","urlToFile","async","url","filename","schema","substr","dataUrlToFile","urlToMime","mime","dataUrlToMime","blobUrlToMime","urlToType","fileToBlobUrl","blobToFile","Blob","blob","File","safeFilename","blobUrl","blobUrlToBlob","blobUrlToType","blobUrlToDataUrl","fileToDataUrl","dataurl","match","dataUrlToType","dataUrlToBlob","arr","bstr","atob","u8arr","Uint8Array","charCodeAt","dataUrlToBlobUrl","fr","FileReader","readAsDataURL","_mime","generateFilename","suffix","zerofill","len","toString","_document$querySelect3","default_filename","now","Date","postname","_document$querySelect","_document$querySelect2","textContent","replace_values","filename_values","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","Math","floor","getTime","toLocaleDateString","toLocaleTimeString","keys","k","replace","extension","trim","pop","exts","types","ext","_jquery","_classStaticPrivateMethodGet","method","_addNotice","dismissible","classes","$headerEnd","first","insertAfter","trigger","i18n","__","Notices","success","notify","warn","_classPrivateMethodInitSpec","privateSet","privateCollection","_defineProperty","key","arg","input","hint","prim","Symbol","toPrimitive","String","Number","res","defineProperty","enumerable","configurable","_classPrivateMethodGet","fn","allowedExtensions","maxFileSize","min","parseInt","max_file_size","_file","_progressHandler","_uploadedHandler","_errorHandler","_isitMe","WeakSet","_upload","_addListeners","_removeListeners","WPUploader","ready","workflow","uploader","_workflow","media","open","wpActiveEditor","frame","title","copy_paste","multiple","_this","up","args","_isitMe2","onProgress","percent","response","onUploaded","_removeListeners2","onError","Uploader","getFilename","destructor","close","upload","_upload2","dump","_addListeners2","addFile","bind","unbind","progress","ErrorEvent","max","_el$parentNode","parentNode","insertBefore","the_paste","newElement","attachment","attributes","link","getUserSetting","string","image","align","video","audio","replaceWith"],"mappings":"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","file":"the-paste-plugin.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import $ from 'jquery'\nimport Converter from 'converter'\nimport Notices from 'notices'\nimport Uploader from 'uploader'\n\nclass PasteOperation {\n\n\tstatic #instance = null\n\tstatic #isEnabled = true\n\n\t#files = []\n\t#isAsync = false\n\n\tstatic init( event, preferFiles = true ) {\n\t\tPasteOperation.#instance = new PasteOperation( event, preferFiles )\n\t\treturn PasteOperation.get();\n\t}\n\n\tstatic get() {\n\t\treturn PasteOperation.#instance\n\t}\n\n\tstatic destroy() {\n\t\tPasteOperation.#instance = null\n\t}\n\n\tstatic setEnabled(enabled) {\n\t\tPasteOperation.#isEnabled = enabled\n\t}\n\n\tget isAsync() {\n\t\treturn this.#isAsync\n\t}\n\n\tget hasPastedFiles() {\n\t\treturn this.files.length > 0\n\t}\n\n\tget pastedContent() {\n\t\treturn this.isAsync\n\t\t\t? '<p id=\"the-pasted-async\"></p>' // paste html\n\t\t\t: this.files.map( (file,idx) => {\n\t\t\t\t\tconst src = URL.createObjectURL(file)\n\t\t\t\t\treturn `<p><img id=\"the-pasted-${file.type}-${idx}\" src=\"${src}\" alt=\"${file.name}\" /></p>`\n\t\t\t\t} )\n\t\t\t\t.join('')\n\t}\n\n\tget files() {\n\t\treturn this.#files\n\t}\n\n\tconstructor( event, preferFiles ) {\n\t\tthis.clipboardData = event.clipboardData\n\t\tthis.body = event.target.closest('body')\n\n\t\tif ( PasteOperation.#isEnabled ) {\n\t\t\tthis.#files = Array.from( this.clipboardData.files??[] )\n\n\t\t\tif ( ! this.files.length || ! preferFiles ) {\n\t\t\t\tthis.#isAsync = Array.from( this.clipboardData.items ).filter( item => item.kind === 'string' && item.type === 'text/html' ).length > 0\n\t\t\t}\n\t\t}\n\n\t\t// no files\n\t\tif ( ! this.isAsync && ! this.files.length ) {\n\t\t\treturn\n\t\t}\n\n\t\tif ( this.isAsync ) {\n\t\t\t// google docs clipboard items present\n\t\t\t(async () => {\n\t\t\t\tlet i, u\n\t\t\t\tconst loc = new URL( document.location )\n\t\t\t\tconst html = await Converter.clipboardItemsToHtml( event.clipboardData.items )\n\t\t\t\tconst div = document.createElement('div')\n\t\t\t\tconst placeholder = this.body.querySelector('#the-pasted-async')\n\t\t\t\tconst images = []\n\n\t\t\t\tdiv.innerHTML = html\n\t\t\t\timages.push( ...Array.from(div.querySelectorAll('img')) )\n\t\t\t\tconst nodes = Array.from(div.childNodes).filter( node => [ Node.ELEMENT_NODE , Node.TEXT_NODE ].includes(node.nodeType))\n\n\t\t\t\tfor ( i=0;i<nodes.length;i++ ) {\n\t\t\t\t\tplaceholder?.before( nodes[i] )\n\t\t\t\t}\n\t\t\t\t// .forEach( node => placeholder?.before( node ) )\n\t\t\t\tplaceholder?.remove()\n\n\t\t\t\tif ( images.length ) {\n\t\t\t\t\tfor ( i=0; i < images.length; i++ ) {\n\t\t\t\t\t\tu = new URL(images[i].src)\n\t\t\t\t\t\tif ( ! ['http:','https:'].includes(u.protocol) || loc.hostname !== u.hostname ) {\n\t\t\t\t\t\t\timages[i].src = await Converter.urlToBlobUrl(images[i].src)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.body.dispatchEvent(new Event('FilesPasted'))\n\t\t\t\t}\n\t\t\t})()\n\t\t} else if ( this.body.querySelector('[src^=\"data:\"]:not(.--paste-process)') ) {\n\t\t\tthis.body.dispatchEvent(new Event('FilesPasted'))\n\t\t}\n\t}\n\n\tdumpClipboardData() {\n\t\tconst prefix = '[the paste]'\n\t\tArray.from(this.clipboardData.files).forEach( el => console.log(prefix,el) )\n\t\tArray.from(this.clipboardData.items).forEach( el => {\n\t\t\tconsole.log(prefix,el,el.kind,el.type)\n\t\t\tif ( 'string' === el.kind ) {\n\t\t\t\tel.getAsString(s=>console.log(s))\n\t\t\t} else {\n\t\t\t\tconsole.log(prefix,el.getAsFile())\n\t\t\t}\n\t\t} )\n\t\treturn this\n\t}\n}\n\n\ntinymce.PluginManager.add( 'the_paste', function(editor) {\n\n\tlet pasteOnOffBtn,\n\t\ttoolbar,\n\t\tisPlaintextState = false\n\n\t// enable / disable autoupload button\n\teditor.addButton( 'thepaste_onoff', {\n\t\ticon: 'thepaste_onoff',\n\t\ttooltip: thepaste.l10n.paste_files,\n\t\tonPostRender: function() {\n\t\t\tpasteOnOffBtn = this;\n\t\t},\n\t\tonClick: function() {\n\t\t\tthis.active( ! this.active() )\n\t\t\tfetch(`${thepaste.options.editor.enable_ajax_url}&enabled=${this.active()?1:0}`)\n\t\t},\n\t\tactive: thepaste.options.editor.enabled\n\t});\n\n\n\t// init media toolbar flyout\n\teditor.once( 'preinit', function() {\n\t\tif ( editor.wp && editor.wp._createToolbar ) {\n\n\t\t\ttoolbar = editor.wp._createToolbar( [\n\t\t\t\t'wp_img_alignleft',\n\t\t\t\t'wp_img_aligncenter',\n\t\t\t\t'wp_img_alignright',\n\t\t\t\t'wp_img_alignnone',\n\t\t\t\t'wp_img_thepaste_upload',\n\t\t\t\t'wp_img_edit',\n\t\t\t\t'wp_img_remove',\n\t\t\t] );\n\t\t}\n\t} );\n\n\t// upload button in media toolbar flyout\n\teditor.addButton('wp_img_thepaste_upload', {\n\t\ticon: 'dashicon dashicons dashicons-upload thepaste-upload',\n\t\ttooltip: thepaste.l10n.upload_image,\n\t\tonclick: function() {\n\t\t\t// wrap img, upload\n\t\t\tUploader.inlineUpload( editor.selection.getNode() )\n\t\t}\n\t});\n\n\t// setup media toolbar flyout on node change\n\teditor.on( 'wptoolbar', function( event ) {\n\t\tvar uploadBtn;\n\t\tif ( event.element.nodeName === 'IMG' && ! editor.wp.isPlaceholder( event.element ) ) {\n\t\t\tevent.toolbar = toolbar;\n\n\t\t\tuploadBtn = toolbar.$el.find('.thepaste-upload').closest('.mce-btn');\n\n\t\t\tif ( canUpload( event.element ) ) {\n\t\t\t\tuploadBtn.show();\n\t\t\t} else {\n\t\t\t\tuploadBtn.hide();\n\t\t\t}\n\t\t}\n\t} );\n\n\n\t// true if data source or blob image\n\tfunction canUpload( img ) {\n\t\tconst sub = img.src.substring(0,5);\n\t\treturn sub === 'blob:' || sub === 'data:';\n\t}\n\n\tconst crawlPastedImages = () => {\n\t\treturn Array.from( editor.dom.doc.body.querySelectorAll('[src^=\"blob:\"]:not(.--paste-process),[src^=\"data:\"]:not(.--paste-process)') )\n\t}\n\n\teditor\n\t\t.on( 'PastePlainTextToggle', ( { state } ) => {\n\t\t\tPasteOperation.setEnabled( ! state )\n\t\t\tpasteOnOffBtn.disabled( state )\n\t\t})\n\t\t.on( 'init', () => {\n\t\t\teditor.dom.doc.body.addEventListener('FilesPasted', async e => {\n\n\t\t\t\tlet i, el\n\t\t\t\tconst images = crawlPastedImages()\n\t\t\t\tfor (i=0; i<images.length;i++) {\n\t\t\t\t\tel = images[i]\n\t\t\t\t\tel.classList.add('--paste-process')\n\t\t\t\t\tUploader.inlineUpload( el ).catch( err => Notices.error( err.message, true ) || el.remove() )\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t\t.on( 'Paste', e => {\n\t\t\tif ( document.body.matches('.modal-open') ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst preferFiles = !pasteOnOffBtn || pasteOnOffBtn.active()\n\t\t\tconst pasteOperation = PasteOperation.init( e, preferFiles ) //\n\t\t\tif ( thepaste.options.editor.debugMode ) {\n\t\t\t\tpasteOperation.dumpClipboardData()\n\t\t\t}\n\t\t\t// pasteOperation.dumpClipboardData()\n\t\t\t// nothing to paste\n\t\t\tif ( ! pasteOperation.isAsync && ! pasteOperation.files.length ) {\n\t\t\t\tPasteOperation.destroy()\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst editorPreProcess = e => {\n\t\t\t\t/*\n\t\t\t\tFF: Not Fired if clipboard contains file from FS\n\t\t\t\t*/\n\t\t\t\tlet content\n\t\t\t\t// get html from pasteOperation\n\t\t\t\tif ( content = pasteOperation.pastedContent ) {\n\t\t\t\t\te.content = content\n\t\t\t\t}\n\n\t\t\t\tPasteOperation.destroy()\n\t\t\t}\n\t\t\tconst editorPostProcess = e => {\n\t\t\t\tsetTimeout( () => editor.dom.doc.body.dispatchEvent(new Event('FilesPasted')))\n\t\t\t\teditor.off( 'PastePreProcess', editorPreProcess )\n\t\t\t\teditor.off( 'PastePostProcess', editorPostProcess )\n\t\t\t}\n\n\t\t\teditor.once( 'input', async ie => {\n\t\t\t\t/*\n\t\t\t\tFired in FF if clipboard contains file from FS\n\t\t\t\t*/\n\t\t\t\tconst images = crawlPastedImages()\n\t\t\t\tlet idx, img\n\t\t\t\tif ( ! images.length ) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tfor ( idx=0; idx < images.length; idx++ ) {\n\t\t\t\t\timg = images[idx]\n\t\t\t\t\tif ( !! pasteOperation.files[idx] ) {\n\t\t\t\t\t\timg.alt = pasteOperation.files[idx].name\n\t\t\t\t\t\timg.src = URL.createObjectURL(pasteOperation.files[idx])\n\t\t\t\t\t\t// img.src = await Converter.dataUrlToBlobUrl(img.src)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tsetTimeout( () => editor.dom.doc.body.dispatchEvent(new Event('FilesPasted')))\n\n\t\t\t\tif ( images.length === pasteOperation.files.length ) {\n\t\t\t\t\t// images already processed\n\t\t\t\t\teditor.off( 'PastePreProcess', editorPreProcess )\n\t\t\t\t\teditor.off( 'PastePostProcess', editorPostProcess )\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on( 'PastePreProcess', editorPreProcess )\n\t\t\t.on( 'PastePostProcess', editorPostProcess )\n\t\t});\n} );\n","// Compatibility with [Real Media Library](https://wordpress.org/plugins/real-media-library-lite/)\n// @see https://github.com/mcguffin/the-paste/issues/47\n\nclass Supports {\n\tget svg() {\n\t\treturn _wpPluploadSettings.defaults.filters.mime_types[0].extensions.split(',').includes('svg')\n\t}\n\tget webp() {\n\t\treturn document.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp') == 0\n\t}\n}\n\nconst rml = {\n\tfile: file => {\n\t\tif ( ! file.getSource ) {\n\t\t\t// return native file object\n\t\t\t// mimic mOxie.Blob.getSource()\n\t\t\tfile.getSource = () => {\n\t\t\t\treturn file\n\t\t\t}\n\t\t}\n\t\treturn file\n\t}\n}\n\nconst supports = new Supports()\n\nmodule.exports = { rml, supports }\n","import { supports } from 'compat'\nimport { safeFilename } from 'filename'\n\n\nconst itemHandler = type => {\n\treturn {\n\t\t'text/plain': async item => {\n\t\t\tif ( supports.svg ) {\n\t\t\t\tconst str = await Converter.itemToString( item )\n\t\t\t\tif ( str.toLowerCase().indexOf('<svg') >= 0 ) {\n\t\t\t\t\tconst domParser = new DOMParser()\n\t\t\t\t\tif ( domParser.parseFromString(str,'image/svg+xml').querySelector('svg') ) {\n\t\t\t\t\t\treturn [ Converter.stringToFile( str, 'image/svg+xml' ) ]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn []\n\t\t},\n\t\t'text/html': async item => {\n\t\t\tconst loc = new URL( document.location )\n\t\t\tconst div = document.createElement('div')\n\t\t\tdiv.innerHTML = await Converter.itemToString( item )\n\n\t\t\tconst imgs = Array.from( div.querySelectorAll('img') )\n\t\t\t\t.filter( img => {\n\t\t\t\t\t// remove images from same domain\n\t\t\t\t\tconst u = new URL(img.src)\n\t\t\t\t\treturn ! ['http:','https:'].includes(u.protocol) || loc.hostname !== u.hostname\n\t\t\t\t} )\n\t\t\t\t.map( img => Converter.elementToFile(img) )\n\n\t\t\treturn new Promise( (resolve,reject) => {\n\t\t\t\tPromise.allSettled( imgs ).then( result => resolve( Array.from(result).map( promise => promise.value )) )\n\t\t\t})\n\t\t},\n\t\t// 'application/x-vnd.google-docs-image-clip+wrapped': async item => await Converter.gdocsItemToFiles( item ), // <== dont need this\n\t}[type]??(()=>new Promise((resolve,reject)=>resolve([])))\n}\n\nconst Converter = {\n\tclipboardItemsToFiles: clipboardItems => {\n\t\tconst files = []\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tconst promises = Array.from(clipboardItems).map( item => {\n\t\t\t\tif ( 'string' === item.kind ) {\n\t\t\t\t\tconst handler = itemHandler(item.type)\n\t\t\t\t\treturn handler( item )\n\t\t\t\t\t\t.then( f => {\n\t\t\t\t\t\t\tfiles.push( ...f.filter( fl => fl.size > 0 ) )\n\t\t\t\t\t\t} )\n\t\t\t\t\t\t.catch( err => console.error(err) )\n\t\t\t\t}\n\t\t\t})\n\t\t\tPromise.allSettled(promises).then( () => resolve(files))\n\t\t})\n\t},\n\tclipboardItemsToHtml:  async clipboardItems => {\n\t\tlet i, item\n\t\tfor ( i=0; i < clipboardItems.length; i++ ) {\n\t\t\titem = clipboardItems[i]\n\t\t\tif ( 'string' === item.kind && 'text/html' === item.type ) {\n\t\t\t\treturn await Converter.itemToString( item )\n\t\t\t}\n\t\t}\n\t\treturn ''\n\t},\n\tgdocsItemToSources: async item => new Promise( (resolve, reject) => {\n\t\titem.getAsString( async str => {\n\t\t\tconst src = Object.values(JSON.parse(JSON.parse( str ).data ).image_urls )\n\t\t\tresolve(src)\n\t\t} )\n\t}),\n\tgdocsItemToFiles: async item => {\n\t\tlet i\n\t\tconst sources = await Converter.gdocsItemToSources(item)\n\t\tconst files = []\n\t\tfor ( i=0;i<sources.length; i++ ) {\n\t\t\tfiles.push( await Converter.blobUrlToFile(sources[i]) )\n\t\t}\n\t\treturn files\n\t},\n\titemToString: async item => new Promise( (resolve, reject) => {\n\t\titem.getAsString( str => resolve(str) )\n\t}),\n\n\telementToFile: async el => {\n\t\tconst file = await Converter.urlToFile(el.src,el.alt)\n\t\treturn file\n\t},\n\n\turlToFile: async ( url, filename = '') => {\n\t\tlet file\n\t\tconst schema = url.substr( 0, url.indexOf(':') )\n\t\tif ( 'data' === schema ) {\n\t\t\tfile = Converter.dataUrlToFile( url, filename )\n\t\t} else if ( ['blob','http','https'].includes( schema ) ) {\n\t\t\tfile = await Converter.blobUrlToFile( url, filename )\n\t\t}\n\t\treturn file\n\t},\n\turlToMime: async url => {\n\t\tconst schema = url.substr( 0, url.indexOf(':') )\n\t\tlet mime\n\t\tif ( 'data' === schema ) {\n\t\t\tmime = Converter.dataUrlToMime( url )\n\t\t} else if ( ['blob','http','https'].includes( schema ) ) {\n\t\t\tmime = await Converter.blobUrlToMime( url )\n\t\t}\n\t\treturn mime\n\t},\n\turlToType: async url => {\n\t\tconst mime = await Converter.urlToMime(url)\n\t\treturn mime.substr( 0, mime.indexOf('/'))\n\t},\n\turlToBlobUrl: async (url) => {\n\t\tconst file = await Converter.blobUrlToFile( url )\n\t\treturn Converter.fileToBlobUrl( file )\n\t},\n\n\tstringToFile: (str, type) => {\n\t\treturn Converter.blobToFile( new Blob( [str], {type} ) )\n\t},\n\n\tblobToFile: ( blob, filename = '' ) => {\n\t\treturn new File([blob], safeFilename( blob, filename ), { type: blob.type } );\n\t},\n\tblobUrlToMime: async blobUrl =>{\n\t\tconst blob = await Converter.blobUrlToBlob(blobUrl)\n\t\treturn blob.type\n\t},\n\tblobUrlToType: async blobUrl => {\n\t\tconst blob = await Converter.blobUrlToBlob(blobUrl)\n\t\treturn blob.type.substr(0,blob.type.indexOf('/'))\n\t},\n\tblobUrlToBlob: async ( blobUrl, filename = '' ) => {\n\t\tconst blob = await fetch( blobUrl ).then( r => r.blob() );\n\t\treturn blob\n\t},\n\tblobUrlToFile: async ( blobUrl, filename = '' ) => {\n\t\tconst blob = await Converter.blobUrlToBlob(blobUrl)\n\t\treturn Converter.blobToFile( blob, filename )\n\t},\n\tblobUrlToDataUrl: async blobUrl => {\n\t\tconst blob = await fetch(blobUrl).then( r => r.blob() );\n\t\tconst dataurl = await Converter.fileToDataUrl(blob)\n\t\treturn dataurl\n\t},\n\n\n\tdataUrlToMime: dataurl => dataurl.match('data:([^;]+);')[1],\n\n\tdataUrlToType: dataurl => dataurl.match('data:([^\\/]+)\\/')[1],\n\n\tdataUrlToBlob: ( dataurl ) => {\n\t\tlet arr = dataurl.split(','),\n\t\t\ttype = arr[0].match(/:(.*?);/)[1],\n\t\t\tbstr = atob(arr[1]),\n\t\t\tn = bstr.length,\n\t\t\tu8arr = new Uint8Array(n);\n\n\t\twhile(n--){\n\t\t\tu8arr[n] = bstr.charCodeAt(n);\n\t\t}\n\t\treturn new Blob( [u8arr], { type: type } )\n\t},\n\n\tdataUrlToFile: ( dataurl, filename = '' ) => Converter.blobToFile( Converter.dataUrlToBlob(dataurl), filename ),\n\n\tdataUrlToBlobUrl: dataurl => Converter.fileToBlobUrl( Converter.dataUrlToBlob( dataurl ) ),\n\n\tfileToBlobUrl: file => URL.createObjectURL(file),\n\n\tfileToDataUrl: file => new Promise( ( resolve, reject ) => {\n\t\tconst fr = new FileReader()\n\t\tfr.addEventListener('load', () => resolve( fr.result )  )\n\t\tfr.readAsDataURL( file )\n\t}),\n}\n\nmodule.exports = Converter\n","import mime from 'mime'\n\n/**\n *\tGenerate a filename\n */\nconst generateFilename = suffix => {\n\n\tconst zerofill = (n,len = 2) => {\n\t\treturn ('00' + n.toString()).substr(-len)\n\t}\n\n\tlet name = thepaste.options.default_filename\n\n\tconst now = new Date(),\n\t\tpostname = document.querySelector('#post [name=\"post_title\"]#title')?.value\n\t\t\t|| document.querySelector('.wp-block-post-title')?.textContent\n\t\t\t|| document.querySelector('h1')?.textContent,\n\t\treplace_values = thepaste.options.filename_values,\n\t\t// username = document.querySelector('.display-name')?.textContent,\n\t\tmap = [\n\t\t\t{ s: '%Y', r: now.getFullYear() },\n\t\t\t{ s: '%y', r: now.getFullYear() % 100 },\n\t\t\t{ s: '%m', r: zerofill(now.getMonth() + 1) },\n\t\t\t{ s: '%d', r: zerofill(now.getDate()) },\n\t\t\t{ s: '%e', r: now.getDate() },\n\t\t\t{ s: '%H', r: zerofill(now.getHours()) },\n\t\t\t{ s: '%I', r: zerofill(now.getHours() % 12 ) },\n\t\t\t{ s: '%M', r: zerofill(now.getMinutes()) },\n\t\t\t{ s: '%S', r: zerofill(now.getSeconds()) },\n\t\t\t{ s: '%s', r: Math.floor( now.getTime() / 1000 ) },\n\t\t\t{ s: '%x', r: now.toLocaleDateString() },\n\t\t\t{ s: '%X', r: now.toLocaleTimeString() }\n\t\t];\n\tif ( 'undefined' !== typeof postname ) {\n\t\tmap.push( { s: '<postname>', r: postname } );\n\t} else {\n\t\tmap.push( { s: '<postname>', r: '' } );\n\t}\n\tObject.keys( replace_values ).forEach( k => {\n\t\tif ( !! replace_values[k] ) {\n\t\t\tmap.push( { s: `<${k}>`, r: replace_values[k] } );\n\t\t} else {\n\t\t\tmap.push( { s: `<${k}>`, r: '' } );\n\t\t}\n\t})\n\tmap.forEach(function(el){\n\t\tname = name.replace( el.s, el.r )\n\t})\n\tif ( 'string' === typeof suffix) {\n\t\tname += '.' + suffix;\n\t}\n\treturn name;\n}\nconst safeFilename = ( file, filename = '' ) => {\n\tlet type = file.type\n\n\tconst suffix = mime.extension(type)\n\tfilename = filename.replace(/[^\\p{L}\\p{M}\\p{S}\\p{N}\\p{P}\\p{Zs}]/ug,'-').trim()\n\tif ( ! filename ) {\n\t\tfilename = generateFilename( suffix )\n\t}\n\tif ( suffix !== filename.split('.').pop() ) {\n\t\tfilename += `.${suffix}`\n\t}\n\treturn filename\n}\n\nmodule.exports = { generateFilename, safeFilename }\n","const exts  = Object.keys( thepaste.options.mime_types )\nconst types = Object.values( thepaste.options.mime_types )\n\n// windows\nexts.push('zip')\ntypes.push('application/x-zip-compressed')\n\nmodule.exports = {\n\textension: type => {\n\t\tconst idx = types.indexOf( type )\n\t\treturn -1 !== idx ? exts[idx] : false\n\t},\n\ttype: ext => {\n\t\tconst idx = exts.indexOf( ext )\n\t\treturn -1 !== idx ? types[idx] : false\n\t}\n}\n","import $ from 'jquery'\n\nclass Notices {\n\n\tstatic #dismissButton = `<button type=\"button\" class=\"notice-dismiss\"><span class=\"screen-reader-text\">${wp.i18n.__( 'Dismiss this notice.' )}</span></button>`;\n\n\tstatic success( message, dismissible = false ) {\n\t\tNotices.#addNotice( 'updated', message, dismissible )\n\t}\n\n\tstatic notify( message, dismissible = false ) {\n\t\tNotices.#addNotice( '', message, dismissible )\n\t}\n\n\tstatic warn( message, dismissible = false ) {\n\t\tNotices.#addNotice( 'notice-warning', message, dismissible )\n\t}\n\n\tstatic error( message, dismissible = false ) {\n\t\tNotices.#addNotice( 'error', message, dismissible )\n\t}\n\n\tstatic #addNotice( type, message, dismissible = false ) {\n\t\tconst classes = `${type} notice ${dismissible?'is-dismissible':''}`.trim()\n\t\tconst html = `<div class=\"${classes}\"><p>${message}</p></div>`;\n\t\tconst $headerEnd = $( '.wp-header-end' ).first();\n\t\t$(html).insertAfter( $headerEnd );\n\t\t$(document).trigger( 'wp-updates-notice-added' );\n\t}\n}\n\nmodule.exports = Notices\n","import mime from 'mime'\nimport Converter from 'converter'\nimport Notices from 'notices'\nimport { rml } from 'compat'\n\nconst allowedExtensions   = _wpPluploadSettings.defaults.filters.mime_types[0].extensions.split(',')\nconst maxFileSize         = Math.min( 1024*1024*200, parseInt(_wpPluploadSettings.defaults.filters.max_file_size) ) // 100MB or uplaod max filesize\n\nconst sizeAllowed = file => {\n\treturn !!file && file.size <= maxFileSize\n}\nconst extensionAllowed = file => {\n\treturn !!file && allowedExtensions.includes( mime.extension( file.type ) )\n}\n\n\nclass WPUploader {\n\tstatic #workflow\n\tonUploaded = () => {}\n\tonProgress = () => {}\n\tonError    = () => {}\n\t#file\n\n\t#progressHandler = (up,args) => {\n\t\tif ( this.#isitMe(args) ) {\n\t\t\tthis.onProgress( args.percent )\n\t\t}\n\t}\n\t#uploadedHandler = ( up, args, response ) => {\n\t\tif ( this.#isitMe(args) ) {\n\t\t\tthis.onUploaded( args )\n\t\t\tthis.#removeListeners()\n\t\t}\n\t}\n\t#errorHandler = ( up, args, c = 0 ) => {\n\t\tif ( this.#isitMe(args) ) {\n\t\t\tthis.onError(args)\n\t\t}\n\t}\n\n\t#isitMe(args) {\n\t\treturn this.#file.name === args.name && this.#file.size === args.size\n\t}\n\n\tstatic get ready() {\n\t\treturn !! WPUploader.workflow.uploader.uploader && !! WPUploader.workflow.uploader.uploader.ready\n\t}\n\n\tstatic get workflow() {\n\t\tif ( ! WPUploader.#workflow ) {\n\t\t\tWPUploader.#workflow = wp.media.editor.open( window.wpActiveEditor, {\n\t\t\t\tframe:    'post',\n\t\t\t\tstate:    'insert',\n\t\t\t\ttitle:    thepaste.l10n.copy_paste,\n\t\t\t\tmultiple: false\n\t\t\t})\n\t\t}\n\t\treturn WPUploader.#workflow\n\t}\n\n\tstatic get uploader() {\n\t\treturn WPUploader.workflow.uploader.uploader.uploader\n\t}\n\n\tstatic get(file) {\n\t\treturn new WPUploader(file)\n\t}\n\n\tconstructor(file) {\n\n\t\t// sanitize file\n\t\tif ( ! file.name ) {\n\t\t\tfile.name = Uploader.getFilename( mime.extension(file.type) )\n\t\t}\n\n\t\tthis.#file = rml.file(file)\n\n\t}\n\n\tdestructor() {\n\t\tWPUploader.workflow.close()\n\t}\n\n\tupload() {\n\t\tif ( WPUploader.ready ) {\n\t\t\tthis.#upload()\n\t\t} else {\n\t\t\tWPUploader.workflow.once( 'uploader:ready', () => {\n\t\t\t\tthis.#upload()\n\t\t\t} );\n\t\t}\n\t}\n\t#upload() {\n\t\tthis.#addListeners()\n\t\tWPUploader.uploader.addFile( this.#file );\n\t\tWPUploader.workflow.close()\n\t}\n\n\t#addListeners() {\n\t\tWPUploader.uploader.bind( 'UploadProgress', this.#progressHandler, this );\n\t\tWPUploader.uploader.bind( 'FileUploaded', this.#uploadedHandler, this );\n\t\tWPUploader.uploader.bind( 'Error', this.#errorHandler, this );\n\t}\n\n\t#removeListeners() {\n\t\tWPUploader.uploader.unbind( 'UploadProgress', this.#progressHandler, this );\n\t\tWPUploader.uploader.unbind( 'FileUploaded', this.#uploadedHandler, this );\n\t\tWPUploader.uploader.unbind( 'Error', this.#errorHandler, this );\n\t}\n\n\tdump() {\n\t\tconsole.log(arguments)\n\t}\n}\n\n\nconst Uploader = {\n\tinlineUpload: async el => {\n\n\t\tconst file = await Converter.elementToFile( el )\n\t\tconst uploader = WPUploader.get(file)\n\t\tconst progress = document.createElement('progress')\n\n\t\tprogress.classList.add('the-paste-progress')\n\n\t\tif ( ! sizeAllowed(file) ) {\n\t\t\tthrow new ErrorEvent('the-paste-upload', { message: `File size exceeds ${maxFileSize} byte`,  })\n\t\t}\n\n\t\tif ( ! extensionAllowed(file) ) {\n\t\t\tthrow new ErrorEvent('the-paste-upload', { message: `Type ${file.type} not allowed`,  })\n\t\t}\n\t\t// dom\n\t\tprogress.max = 100\n\t\tel.parentNode?.insertBefore(progress,el)\n\t\tel.remove()\n\t\t// upload process\n\t\tuploader.onProgress = percent => {\n\t\t\tprogress.value = percent\n\t\t}\n\t\tuploader.onError = error => {\n\t\t\tconsole.error(error)\n\t\t\tNotices.error( `<strong>${thepaste.l10n.the_paste}:</strong> ${error.message} File: <em>${file.name}</em>`, true )\n\t\t\tprogress.remove()\n\t\t}\n\t\tuploader.onUploaded = args => {\n\n\t\t\tconst newElement = document.createElement('p')\n\t\t\tconst attachment = args.attachment.attributes\n\t\t\tconst link = getUserSetting( 'urlbutton', 'none' )\n\n\t\t\tif ( 'image' === attachment.type ) {\n\t\t\t\tnewElement.innerHTML = wp.media.string.image( {\n\t\t\t\t\tlink,\n\t\t\t\t\talign: getUserSetting( 'align', 'none' ),\n\t\t\t\t\tsize:  getUserSetting( 'imgsize', 'medium' ),\n\t\t\t\t}, attachment )\n\n\t\t\t} else if ( 'video' === attachment.type ) {\n\t\t\t\tnewElement.innerHTML = wp.media.string.video( {\n\t\t\t\t\tlink: link !== 'none'\n\t\t\t\t\t\t? link\n\t\t\t\t\t\t: 'embed'\n\t\t\t\t}, attachment )\n\n\t\t\t} else if ( 'audio' === attachment.type ) {\n\t\t\t\tnewElement.innerHTML = wp.media.string.audio( {\n\t\t\t\t\tlink: link !== 'none'\n\t\t\t\t\t\t? link\n\t\t\t\t\t\t: 'embed'\n\t\t\t\t}, attachment )\n\n\t\t\t} else {\n\t\t\t\tnewElement.innerHTML = wp.media.string.link( {\n\t\t\t\t\tlink: link !== 'none'\n\t\t\t\t\t\t? link\n\t\t\t\t\t\t: 'file'\n\t\t\t\t}, attachment )\n\t\t\t}\n\t\t\tprogress.replaceWith( newElement.childNodes[0] )\n\t\t}\n\t\tuploader.upload()\n\t},\n\t/**\n\t *\tGenerate a filename\n\t */\n\tgetFilename: suffix => {\n\n\t\tconst zerofill = (n,len = 2) => {\n\t\t\treturn ('00' + n.toString()).substr(-len)\n\t\t}\n\n\t\tlet name = thepaste.options.default_filename\n\n\t\tconst now = new Date(),\n\t\t\tpostname = document.querySelector('#post [name=\"post_title\"]#title').value,\n\t\t\tusername = document.querySelector('.display-name').textContent,\n\t\t\tmap = [\n\t\t\t\t{ s: '%Y', r: now.getFullYear() },\n\t\t\t\t{ s: '%y', r: now.getFullYear() % 100 },\n\t\t\t\t{ s: '%m', r: zerofill(now.getMonth() + 1) },\n\t\t\t\t{ s: '%d', r: zerofill(now.getDate()) },\n\t\t\t\t{ s: '%e', r: now.getDate() },\n\t\t\t\t{ s: '%H', r: zerofill(now.getHours()) },\n\t\t\t\t{ s: '%I', r: zerofill(now.getHours() % 12 ) },\n\t\t\t\t{ s: '%M', r: zerofill(now.getMinutes()) },\n\t\t\t\t{ s: '%S', r: zerofill(now.getSeconds()) },\n\t\t\t\t{ s: '%s', r: Math.floor( now.getTime() / 1000 ) }\n\t\t\t];\n\t\tif ( 'undefined' !== typeof postname ) {\n\t\t\tmap.push( { s: '<postname>', r: postname } );\n\t\t} else {\n\t\t\tmap.push( { s: '<postname>', r: '' } );\n\t\t}\n\t\tmap.forEach( function(el) {\n\t\t\tname = name.replace( el.s, el.r )\n\t\t})\n\t\tif ( 'string' === typeof suffix) {\n\t\t\tname += '.' + suffix;\n\t\t}\n\t\treturn name;\n\t}\n}\nmodule.exports = Uploader\n"]}