!function e(t,i,n){function a(s,r){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=i[s]={exports:{}};t[s][0].call(p.exports,(function(e){return a(t[s][1][e]||e)}),p,p.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,i){"use strict";var n=s(e("converter")),a=s(e("image-dialog")),o=e("compat");function s(e){return e&&e.__esModule?e:{default:e}}const r=wp.media.View.extend({template:wp.template("the-paste-instructions"),className:"the-paste-instructions",render:function(){wp.media.View.prototype.render.apply(this,arguments),setInterval((()=>{this.$el.prop("hidden",!document.hasFocus())}),100)}});_.extend(wp.media.view.MediaFrame.prototype,{_parentInitialize:wp.media.view.MediaFrame.prototype.initialize,initialize:function(e){this._parentInitialize.apply(this,arguments),this.on("attach",this.addPasteInstructions,this),this.pasteInstructions=new r,this.pasteInstructions.render()},addPasteInstructions:function(){this.$el.find("#media-frame-title").append(this.pasteInstructions.el)}}),_.extend(wp.media.view.AttachmentsBrowser.prototype,{_parentInitialize:wp.media.view.AttachmentsBrowser.prototype.initialize,initialize:function(){this._parentInitialize.apply(this,arguments);const e=new r({priority:-10});e.render(),this.toolbar.set("pasteInstructions",e),document.addEventListener("paste",(async e=>{if(!this.$el.is(":visible"))return;const t=Array.from(e.clipboardData.files);return t.length&&(e.preventDefault(),e.stopPropagation()),t.push(...await n.default.clipboardItemsToFiles(e.clipboardData.items)),t.length?await this.handlePastedFiles(t):void 0}),{capture:!0})},handlePastedFiles:async function(e){const t=[],i=this.controller.uploader.uploader.uploader;if(e.forEach((e=>{/^image\//.test(e.type)?t.push(e):i.addFile(o.rml.file(e))})),t.length){(await(0,a.default)(t)).forEach((e=>i.addFile(o.rml.file(e))))}}})},{compat:2,converter:3,"image-dialog":5}],2:[function(e,t,i){"use strict";const n=new class{get svg(){return _wpPluploadSettings.defaults.filters.mime_types[0].extensions.split(",").includes("svg")}get webp(){return 0==document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}};t.exports={rml:{file:e=>(e.getSource||(e.getSource=()=>e),e)},supports:n}},{}],3:[function(e,t,i){"use strict";e("compat");var n=e("filename");const a={clipboardItemsToFiles:e=>{const t=[];return new Promise(((i,n)=>{const o=Array.from(e).map((e=>{if("string"===e.kind){const o=(i=e.type,null!==(n={"text/plain":async e=>{const t=await a.itemToString(e);return t.toLowerCase().indexOf("<svg")>=0&&(new DOMParser).parseFromString(t,"image/svg+xml").querySelector("svg")?[a.stringToFile(t,"image/svg+xml")]:[]},"text/html":async e=>{const t=new URL(document.location),i=document.createElement("div");i.innerHTML=await a.itemToString(e);const n=Array.from(i.querySelectorAll("img")).filter((e=>{const i=new URL(e.src);return!["http:","https:"].includes(i.protocol)||t.hostname!==i.hostname})).map((e=>a.elementToFile(e)));return new Promise(((e,t)=>{Promise.allSettled(n).then((t=>e(Array.from(t).map((e=>e.value)))))}))}}[i])&&void 0!==n?n:()=>new Promise(((e,t)=>e([]))));return o(e).then((e=>{t.push(...e.filter((e=>e.size>0)))})).catch((e=>console.error(e)))}var i,n}));Promise.allSettled(o).then((()=>i(t)))}))},clipboardItemsToHtml:async e=>{let t,i;for(t=0;t<e.length;t++)if(i=e[t],"string"===i.kind&&"text/html"===i.type)return await a.itemToString(i);return""},gdocsItemToSources:async e=>new Promise(((t,i)=>{e.getAsString((async e=>{const i=Object.values(JSON.parse(JSON.parse(e).data).image_urls);t(i)}))})),gdocsItemToFiles:async e=>{let t;const i=await a.gdocsItemToSources(e),n=[];for(t=0;t<i.length;t++)n.push(await a.blobUrlToFile(i[t]));return n},itemToString:async e=>new Promise(((t,i)=>{e.getAsString((e=>t(e)))})),elementToFile:async e=>await a.urlToFile(e.src,e.alt),urlToFile:async function(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.substr(0,e.indexOf(":"));return"data"===n?t=a.dataUrlToFile(e,i):["blob","http","https"].includes(n)&&(t=await a.blobUrlToFile(e,i)),t},urlToMime:async e=>{const t=e.substr(0,e.indexOf(":"));let i;return"data"===t?i=a.dataUrlToMime(e):["blob","http","https"].includes(t)&&(i=await a.blobUrlToMime(e)),i},urlToType:async e=>{const t=await a.urlToMime(e);return t.substr(0,t.indexOf("/"))},urlToBlobUrl:async e=>{const t=await a.blobUrlToFile(e);return a.fileToBlobUrl(t)},stringToFile:(e,t)=>a.blobToFile(new Blob([e],{type:t})),blobToFile:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new File([e],(0,n.safeFilename)(e,t),{type:e.type})},blobUrlToMime:async e=>(await a.blobUrlToBlob(e)).type,blobUrlToType:async e=>{const t=await a.blobUrlToBlob(e);return t.type.substr(0,t.type.indexOf("/"))},blobUrlToBlob:async function(e){return await fetch(e).then((e=>e.blob()))},blobUrlToFile:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=await a.blobUrlToBlob(e);return a.blobToFile(i,t)},blobUrlToDataUrl:async e=>{const t=await fetch(e).then((e=>e.blob()));return await a.fileToDataUrl(t)},dataUrlToMime:e=>e.match("data:([^;]+);")[1],dataUrlToType:e=>e.match("data:([^/]+)/")[1],dataUrlToBlob:e=>{let t=e.split(","),i=t[0].match(/:(.*?);/)[1],n=atob(t[1]),a=n.length,o=new Uint8Array(a);for(;a--;)o[a]=n.charCodeAt(a);return new Blob([o],{type:i})},dataUrlToFile:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a.blobToFile(a.dataUrlToBlob(e),t)},dataUrlToBlobUrl:e=>a.fileToBlobUrl(a.dataUrlToBlob(e)),fileToBlobUrl:e=>URL.createObjectURL(e),fileToDataUrl:e=>new Promise(((t,i)=>{const n=new FileReader;n.addEventListener("load",(()=>t(n.result))),n.readAsDataURL(e)}))};t.exports=a},{compat:2,filename:4}],4:[function(e,t,i){"use strict";var n,a=(n=e("mime"))&&n.__esModule?n:{default:n};const o=e=>{var t,i,n;const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("00"+e.toString()).substr(-t)};let o=thepaste.options.default_filename;const s=new Date,r=(null===(t=document.querySelector('#post [name="post_title"]#title'))||void 0===t?void 0:t.value)||(null===(i=document.querySelector(".wp-block-post-title"))||void 0===i?void 0:i.textContent)||(null===(n=document.querySelector("h1"))||void 0===n?void 0:n.textContent),l=thepaste.options.filename_values,c=[{s:"%Y",r:s.getFullYear()},{s:"%y",r:s.getFullYear()%100},{s:"%m",r:a(s.getMonth()+1)},{s:"%d",r:a(s.getDate())},{s:"%e",r:s.getDate()},{s:"%H",r:a(s.getHours())},{s:"%I",r:a(s.getHours()%12)},{s:"%M",r:a(s.getMinutes())},{s:"%S",r:a(s.getSeconds())},{s:"%s",r:Math.floor(s.getTime()/1e3)},{s:"%x",r:s.toLocaleDateString()},{s:"%X",r:s.toLocaleTimeString()}];return void 0!==r?c.push({s:"<postname>",r:r}):c.push({s:"<postname>",r:""}),Object.keys(l).forEach((e=>{l[e]?c.push({s:"<".concat(e,">"),r:l[e]}):c.push({s:"<".concat(e,">"),r:""})})),c.forEach((function(e){o=o.replace(e.s,e.r)})),"string"==typeof e&&(o+="."+e),o};t.exports={generateFilename:o,safeFilename:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.type;const n=a.default.extension(i);return t=t.replace(/[^\p{L}\p{M}\p{S}\p{N}\p{P}\p{Zs}]/gu,"-").trim(),t||(t=o(n)),n!==t.split(".").pop()&&(t+=".".concat(n)),t}}},{mime:7}],5:[function(e,t,i){(function(i){(function(){"use strict";var n=o("undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null),a=o(e("image-list"));function o(e){return e&&e.__esModule?e:{default:e}}let s=null,r=null;t.exports=e=>new Promise(((t,i)=>{if(null!==s)return r.addFiles(e),void t([]);s=new wp.media.view.Modal({events:{keydown:function(e){"Enter"===e.key?r.submit():"Escape"===e.key&&s.close()},"click .media-modal-close":function(e){s.close()}},controller:{trigger:()=>{}},title:thepaste.l10n.the_paste}),r=new a.default({controller:s});const o=(0,n.default)("body").is(".modal-open");r.on("thepaste:submit",(async()=>{const e=await r.getFiles();s.close(),t(e)})),r.on("thepaste:cancel",(()=>{s.close(),t([])})),s.content(r),r.addFiles(e),s.open(),s.on("close",(()=>{(0,n.default)("body").toggleClass("the-paste-modal-open",!1),(0,n.default)("body").toggleClass("modal-open",o),setTimeout((()=>{s.remove(),s=null}),10)})),(0,n.default)("body").toggleClass("the-paste-modal-open",!0)}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"image-list":6}],6:[function(e,t,i){"use strict";var n=r(e("converter")),a=r(e("mime")),o=e("compat"),s=e("filename");function r(e){return e&&e.__esModule?e:{default:e}}const l=wp.media.View.extend({tagName:"form",template:wp.template("the-paste-image-list-item"),className:"the-paste-image-list-item",events:{'click [name="discard"]':"discard",'change [name="the-paste-format"]':"updateView"},initialize:function(e){let{file:t}=e;wp.media.View.prototype.initialize.apply(this,arguments),this.file=t,new Promise(((e,i)=>{const a=new Image;a.addEventListener("load",(function(){e(a)})),a.src=n.default.fileToBlobUrl(t)})).then((e=>{let t=e.width&&e.height;this.canvas=this.$("canvas").get(0),"image/svg+xml"===this.file.type&&(t?document.body.append(e):this.canvas.after(e)),this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").drawImage(e,0,0),"image/svg+xml"===this.file.type&&(t?e.remove():this.$('[data-format]:not([data-format="image/svg+xml"])').remove())}))},updateView:function(){const e=this.$('[name="the-paste-format"]:checked').val();e!==this.file.type&&["image/webp","image/jpeg"].includes(e)?this.$(".the-paste-quality").show():this.$(".the-paste-quality").hide()},render:function(){wp.media.View.prototype.render.apply(this,arguments);const e=this.file.type,t=this.file.name.replace(/\.([^\.]*)$/,"");o.supports.webp||"image/webp"!==e&&this.$('[data-format="image/webp"]').remove(),this.$('[name="the-paste-format"][value="'.concat(e,'"]')).prop("checked",!0),this.$('[name="the-paste-filename"]').val(t),this.$('[name="the-paste-filename"]').prop("placeholder",(0,s.generateFilename)()),o.supports.svg&&"image/svg+xml"===e||(this.$('[data-format="image/svg+xml"]').remove(),"image/svg+xml"===e&&this.$('[name="the-paste-format"][value="image/png"]').prop("checked",!0)),this.updateView()},getFile:function(){const e=this.$('[name="the-paste-format"]:checked').val(),t=this.$('[name="the-paste-filename"]').val()||(0,s.generateFilename)(),i="".concat(t,".").concat(a.default.extension(e)),o=parseFloat(this.$('[name="the-paste-quality"]').val())||thepaste.options.jpeg_quality;return this.file.type===e?new Promise(((t,n)=>{t(new File([this.file],i,{type:e}))})):new Promise(((t,a)=>{this.canvas.toBlob((e=>{t(n.default.blobToFile(e,i))}),e,.01*o)}))},discard:function(){this.controller.discardItem(this)}}),c=wp.media.View.extend({template:wp.template("the-paste-image-list"),className:"the-paste-image-list",events:{"click .media-frame-toolbar button":"submit"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments),this.files=[],this.items=[],this.button=new wp.media.view.Button({className:"button-primary button-hero"}),this.render()},discardItem:function(e){this.files=this.files.filter((t=>t!==e.file)),this.items=this.items.filter((t=>t!==e)),e.$el.remove(),this.items.length||this.trigger("thepaste:cancel")},addFiles:function(e){this.files.push(...e),e.forEach((e=>{const t=new l({file:e,controller:this});t.render(),this.$(".content").append(t.$el),this.items.push(t),t.render()}))},getFiles:async function(){const e=[];for(const t of this.items)e.push(await t.getFile());return e},submit:function(){this.trigger("thepaste:submit")}});t.exports=c},{compat:2,converter:3,filename:4,mime:7}],7:[function(e,t,i){"use strict";const n=Object.keys(thepaste.options.mime_types),a=Object.values(thepaste.options.mime_types);n.push("zip"),a.push("application/x-zip-compressed"),t.exports={extension:e=>{const t=a.indexOf(e);return-1!==t&&n[t]},type:e=>{const t=n.indexOf(e);return-1!==t&&a[t]}}},{}]},{},[1]);
//# sourceMappingURL=the-paste.js.map
